<ion-view view-title="client">
  <div class="index-right home">
    <header class="clearfix">
      <div class="fl text">
        订单宝
        <small>
              店主端
            </small>
      </div>
      <inst-message></inst-message>
    </header>
    <div class="clients">
      <div class="filter-time" ng-class="isBetClients?'':'filter-time2'">
        <div class="left-filter" ng-if="isBetClients">
          <input type="datetime-local" ng-model="search.startDate" name="beginTime" required ng-change="whetherInMonth()" /> —
          <input type="datetime-local" ng-model="search.endDate" name="endTime" required />
          <!-- <i class="icon-triangle-down"></i> -->
        </div>
        <div class="left-filter" ng-if="!isBetClients">
          <a class="create-btn" ng-class="" ng-click="openCreateAssist()">创建角色</a>
        </div>
        <div class="search-content-wrap">
          <div class="search-content">

            <input type="text" name="" ng-model="search.name" placeholder="  输入昵称查找" />
          </div>
          <i class="icon-search" style="font-size: 40px;margin-left:.2rem; " ng-click="searchClients()"></i>
        </div>
        <a class="search-btn" ng-class="isBetClients?'choosed-btn':''" ng-click="chooseOne('betters')">彩民管理</a>
        <a class="search-btn" ng-class="isBetClients?'':'choosed-btn'" ng-click="chooseOne('assist')">角色管理</a>
      </div>
      <div class="clients-table">
        <div class="table-head">
          <span style="width:1.6rem;" ng-if="isBetClients">用户昵称</span>
          <span style="width:1.6rem;" ng-if="!isBetClients">用户名</span>
          <span style="width:1.82rem;">备注名</span>
          <span style="width:1.7rem">联系方式</span>

          <span style="width: 1.85rem;" class="have-arrows pos1" ng-click="col='DealCount';desc=!desc;arrow[0]=!arrow[0]">
            <i>累计成交次数</i>
            <i ng-class="{'color1': arrow[0]}" class="icon-triangle-up arrow pos1"></i>
            <i ng-class="{'color1': !arrow[0]}" class="icon-triangle-down arrow pos1"></i>
          </span>
          <span style="width: 1.85rem;" class="have-arrows pos1" ng-click="col='outTicketSumMoney/100';desc=!desc;arrow[1]=!arrow[1]">
            <i>累计出票金额</i>
            <i ng-class="{'color1': arrow[1]}" class="icon-triangle-up arrow pos1"></i>
            <i ng-class="{'color1': !arrow[1]}" class="icon-triangle-down arrow pos1"></i>
          </span>
          <span style="width: 1.54rem;" class="have-arrows pos2" ng-click="col='RecentlyTakeOrder';desc=!desc;arrow[2]=!arrow[2]" ng-show="isBetClients">
            <i>{{oView.text4}}</i>
            <i ng-class="{'color1': arrow[2]}" class="icon-triangle-up arrow "></i>
            <i ng-class="{'color1': !arrow[2]}" class="icon-triangle-down arrow "></i>
          </span>
          <!-- <span style="width:1.54rem" ng-if="isBetClients">{{oView.text4}}</span> -->
          <span class="have-arrows pos2" ng-click="col='customer.money/100';desc=!desc;arrow[3]=!arrow[3]" style="width:1.48rem" ng-show="isBetClients">
            <i>{{oView.text5}}</i>
            <i ng-class="{'color1': arrow[3]}" class="icon-triangle-up arrow "></i>
            <i ng-class="{'color1': !arrow[3]}" class="icon-triangle-down arrow "></i>
          </span>
          <!-- <span style="width:1.48rem" ng-if="isBetClients">{{oView.text5}}</span> -->
          <span style="width:1.94rem" ng-if="!isBetClients">{{oView.text4}}</span>
          <span style="width:1.94rem" ng-if="!isBetClients">{{oView.text5}}</span>
          <span style="width:3.36rem" ng-if="isBetClients">操作</span>
          <span style="width:2.5rem" ng-if="!isBetClients">操作</span>
        </div>
        <div style="text-align: center;" ng-if="allClients.length === 0">
          <img src="common/img/blank.png" >
        </div>
        <ion-scroll direction="y" style="height: 7.13rem">
          <div class="table-body" ng-repeat="client in allClients | orderBy:col:desc">
            <span style="width:1.6rem" ng-if="isBetClients">{{client.customer.nickName}}</span>
            <span style="width:1.6rem" ng-if="!isBetClients">{{client.customer.account}}</span>
            <span class="remark-name"><a ng-cloak ng-click="editName($index)">{{client.customer.remark}}</a></span>
            <span style="width:1.7rem" ng-cloak>{{client.customer.phone}}</span>
            <span style="width:1.85rem" ng-cloak>{{client.DealCount}}</span>
            <span style="width:1.85rem" ng-cloak>{{client.outTicketSumMoney/100}}</span>
            <span style="width:1.54rem" ng-if="isBetClients" ng-cloak>{{client.RecentlyTakeOrder}}</span>
            <span style="width:1.48rem" ng-if="isBetClients" ng-cloak>{{client.customer.money/100 | number:2}}</span>
            <span style="width:1.94rem"  ng-if="!isBetClients" ng-cloak>{{client.inStoreRecharge/100 | number:2}}</span>
            <span style="width:1.94rem" ng-if="!isBetClients" ng-cloak>{{client.inStoreCash/100 | number:2}}</span>
            <span style="width:3.36rem" class="oper-td" ng-if="isBetClients">
              <a ng-if="client.customer.delFlag === '0'" ng-click="frozeClient($index)">冻结</a>
              <a ng-if="client.customer.delFlag === '1'">已冻结</a>
              <a ng-if="client.customer.delFlag === '0'" ng-click="editName($index)">修改备注名</a>
              <a ng-click="cancelFrozen($index)" ng-if="client.customer.delFlag === '1'">解除冻结</a>
              <a ng-click="gotoDetail($index)">下单明细</a>
            </span>
            <span style="width:2.5rem" class="oper-td" ng-if="!isBetClients">
              <a ng-click="doManageRight($index)">权限管理</a>
              <a ng-click="frozeClient($index)">删除</a>
            </span>
          </div>
          <div style="text-align: center;" ng-if="allClients.length !== 0 && showLastPic === true">
            <img src="common/img/nomore.png"  class="last-pic">
          </div>
          <ion-infinite-scroll ng-if="moreClients.moredata" on-infinite="moreClients.loadMore()" distance="1%"></ion-infinite-scroll>
        </ion-scroll>
      </div>

    </div>
  </div>
</ion-view>
<script type="text/javascript"></script>
<script id="editNameModal.html" type="text/ng-template">
  <ion-modal-view id="editNameModal">
    <h1 class="head">修改备注名</h1>
    <div>
      <p class="text1">*设置备注名后，将展示用户的备注名称</p>
      <div class="text2 clearfix">
        <span>账户名：</span>
        <span ng-cloak>{{thisClient.customer.account}}</span>
        <!-- <span ng-cloak>ffffff</span> -->
      </div>
      <form role="form" name="editNameForm" ng-submit="submitEditName()">
        <div class="text3 clearfix">
          <span style="margin-top: .18rem;">备注名：</span>
          <label style="float: left;">
            <input autofocus="autofocus" id="remarkName" type="text" name="remarkName" ng-model="operations.editdRemarkName" ng-required="true" ng-trim="true" ng-pattern="/^[a-zA-Z0-9\u4E00-\u9FA5\uF900-\uFA2D]{1,10}$|^[a-zA-Z0-9]+$/">
            <!-- <input type="text" name="" ng-model="editdName" ng-maxlength="15" ng-required="true" ng-trim="true" ng-pattern="/^[a-zA-Z0-9_]{3,16}$/"> -->
            <div class="icon-guanbi error" ng-show="editNameForm.remarkName.$dirty && editNameForm.remarkName.$invalid">字母、数字或包含中文但不多于10位</div>
          </label>
        </div>
        <div class="text4">
          <input type="submit" ng-class="editNameForm.$invalid?'disable-btn':''" ng-disabled="editNameForm.$invalid" value="保存修改" />
          <a ng-click="editNameModal.hide()">关闭</a>
        </div>
      </form>
    </div>
  </ion-modal-view>
</script>
<script id="frozenClientModal.html" type="text/ng-template">
  <ion-modal-view id="frozenClientModal">
    <h1 class="head">{{oView.h1}}</h1>
    <div style="padding-left: .44rem;">
      <p class="text5">确认要将
        <span ng-cloak class="text5-spc">{{thisClient.customer.account}}</span> 账户{{oView.text1}}吗？
      </p>
      <div class="text6 clearfix">
        <span>操作密码：</span>
        <input type="password" autofocus="autofocus" name="" ng-model="operations.password">
        <a class="" ng-click="frozenClientModal.hide()" ui-sref="modules.mine.accountSets({editAccount:'editAccount'})">设置操作密码</a>
      </div>
      <div class="text4">
        <a ng-click="confirmFrozenClient(thisClient.customer.id)">{{oView.text2}}</a>
        <a ng-click="frozenClientModal.hide()">关闭</a>
      </div>
      <p class="text7">
        {{oView.text3}}
      </p>
    </div>
  </ion-modal-view>
</script>
<script id="cancelFrozenClientModal.html" type="text/ng-template">
  <ion-modal-view id="cancelFrozenClientModal">
    <h1 class="head">解除冻结</h1>
    <div style="padding-left: .44rem;">
      <p class="text5">确认要将
        <span ng-cloak class="text5-spc">{{thisClient.customer.account}}</span> 账户解除冻结吗？
      </p>
      <div class="text6 clearfix">
        <span>操作密码：</span>
        <input type="password" autofocus="autofocus" name="" ng-model="operations.password">
        <a class="" ng-click="cancelFrozenClientModal.hide()" ui-sref="modules.mine.accountSets({editAccount:'editAccount'})">设置操作密码</a>
      </div>
      <div class="text4">
        <a ng-click="confirmCancelFrozen($index)">解除冻结</a>
        <a ng-click="cancelFrozenClientModal.hide()">关闭</a>
      </div>
      <!-- <p class="text7">
        {{oView.text3}}
      </p> -->
    </div>
  </ion-modal-view>
</script>
<script id="rightsManageModal.html" type="text/ng-template">
  <ion-modal-view id="rightsManageModal">
    <h1 class="head">权限管理</h1>
    <div class="right-list ">
      <ion-checkbox ng-model="right.check" ng-repeat="right in thisClient.rightsArr">{{right.name}}</ion-checkbox>
    </div>
    <div class="text4">
      <a ng-click="saveManageRight()">保存</a>
      <a ng-click="rightsManageModal.hide()">关闭</a>
    </div>
  </ion-modal-view>
</script>
<script id="createAssistModal.html" type="text/ng-template">
  <ion-modal-view id="createAssistModal">
    <h1 class="head">创建角色</h1>
    <div class="img-wrap">
      <img src="./common/img/headImg.png" style="width: 1.2rem;height: 1.2rem;" alt="userImg" />
    </div>
    <form class="form-style" role="form" name="inputCreateInfo" ng-submit="submitCreateAssist()">
      <div class="text1 clearfix">
        <span>用户名:</span>
        <label>
          <input id="accountName" type="text" name="accountName" ng-model="oCreateRole.account" ng-required="true" ng-trim="true" ng-pattern="/^(\w){6,16}$/">
          <span class="icon-guanbi error" ng-show="inputCreateInfo.accountName.$dirty && inputCreateInfo.accountName.$invalid">6-16位字母、数字或下划线</span>
        </label>
      </div>
      <div class="text1 clearfix">
        <span>手机号码:</span>
        <label>
          <input id="phone" type="text" name="phone" ng-model="oCreateRole.phone" ng-required="true" ng-trim="true" ng-pattern="/^1\d{10}$/">
          <span class="icon-guanbi error" ng-show="inputCreateInfo.phone.$dirty && inputCreateInfo.phone.$invalid">11位手机号码</span>
        </label>
      </div>

      <div class="text1 clearfix">
        <span>登录密码:</span>
        <label>
          <input id="loginPassword" type="password" name="loginPassword" ng-model="oCreateRole.loginPassword" ng-required="true" ng-trim="true" ng-pattern="/^(\w){6,16}$/">
          <span class="icon-guanbi error" ng-show="inputCreateInfo.loginPassword.$dirty && inputCreateInfo.loginPassword.$invalid">6-16位字母、数字或下划线</span>
        </label>
      </div>
      <div class="text1 clearfix have-border">
        <span>操作及支付密码:</span>
        <label>
          <input id="payPassword" type="password" name="payPassword" ng-model="oCreateRole.payPassword" ng-required="true" ng-trim="true" ng-pattern="/^(\w){6,16}$/">
          <span class="icon-guanbi error" ng-show="inputCreateInfo.payPassword.$dirty && inputCreateInfo.payPassword.$invalid">6-16位字母、数字或下划线</span>
        </label>
      </div>

      <!-- <div class="text1 clearfix have-border">
        <span>初始登录密码:</span>
        <input type="password" name="" ng-model="">
        <span style="text-align: left;">123456</span>
      </div> -->
      <div class="right-list ">
        <ion-checkbox ng-model="right.check" ng-repeat="right in allRights">{{right.right}}</ion-checkbox>
      </div>
      <div class="text4">
        <input type="submit" ng-class="inputCreateInfo.$invalid?'disable-btn':''" value="确定" />
        <a ng-click="createAssistModal.hide()">关闭</a>
      </div>
    </form>
  </ion-modal-view>
</script>
